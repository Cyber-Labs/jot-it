<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>JoTIt</title>
        <style>
            .container {
                margin: 15px auto;
                border: 1px solid;
                border-radius: 5px;
                border-color: var(--vscode-editor-foreground);
                width: 95%;
            }
            #notes {
                background-color: var(--vscode-editor-background);
                width: 95%;
                margin: auto;
                padding: 8px;
                height: 250px;
                color: rgb(211, 206, 206);
                font-size: 1.2rem;
                font-family: Arial;
            }
            form {
                display: flex;
                flex-flow: column;
            }
            label {
                font-size: 1.4rem;
                padding: 10px;
            }
            #keyword {
                width: 95%;
                margin: auto;
                background-color: var(--vscode-editor-background);
                color: var(--vscode-editor-foreground);
            }
            input {
                font-size: 1.2rem;
                padding: 8px;
            }
            #imageUri,
            #tagInput {
                width: 95%;
                margin: auto;
                background-color: var(--vscode-editor-background);
                color: var(--vscode-editor-foreground);
            }
            .tag {
                background-color: var(
                    --vscode-editorGroupHeader-tabsBackground
                );
                margin: auto;
                padding: auto;
                font-size: 1.4rem;
                padding: 10px;
            }
            #add-btn {
                background-color: var(--vscode-button-background);
                border: none;
                margin: 20px 10px;
                width: 100px;
                padding: 10px;
                color: var(--vscode-editor-foreground);
            }
            #error {
                background: rgb(236, 4, 4);
                color: white;
                margin: 12px auto;
                font-size: 1rem;
                height: 25px;
                width: 95%;
                padding: 8px;
            }
            .tagContainer {
                display: hidden;
                width: 95%;
                margin: auto;
                align-items: right;
                padding: auto;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div id="error" style="display: none">Keyword Cannot Be Null</div>
            <form>
                <label for="keyword">Keyword</label>
                <input name="keyword" id="keyword" type="text" />
                <label for="imageUri">Image URL</label>
                <input name="imageUri" id="imageUri" type="text" />
                <label for="tags">Tags</label>
                <div id="tagContainer"></div>
                <input type="text" name="tagInput" id="tagInput" />
                <button onclick="addTags()" id="add-btn">Add Tag</button>
                <label for="notes">Notes To Save</label>
                <textarea
                    id="notes"
                    name="notes"
                    row="40"
                    cols="100"
                ></textarea>
                <button onclick="addNote()" id="add-btn">Add Note</button>
            </form>
        </div>
        <script>
            var Tags = [];
            const vscode = acquireVsCodeApi();
            function addNote() {
                let keyword = document.getElementById('keyword').value;
                keyword = keyword.trim();
                if (keyword === '') {
                    document.getElementById('error').style.display = 'block';
                    setTimeout(() => {
                        document.getElementById('error').style.display = 'none';
                    }, 2000);
                    return;
                }
                const imageUri = document.getElementById('imageUri').value;
                let text = document.getElementById('notes').value;
                let message = {
                    keyword,
                    imageUri,
                    text,
                    tags: Tags,
                };
                vscode.postMessage({ type: 'form', message: message });
            }
            function addTags() {
                let tagContainer = document.getElementById('tagContainer');
                let tag = document.createElement('span');
                tag.innerText = document
                    .getElementById('tagInput')
                    .value.trim();
                if (tag.innerText === '') {
                    document.getElementById('error').style.display = 'block';
                    setTimeout(() => {
                        document.getElementById('error').style.display = 'none';
                    }, 2000);
                    return;
                }
                tag.classList.add('tag');
                Tags.push(tag.innerText);
                tagContainer.appendChild(tag);
                console.log(tagContainer.children);
                tagContainer.style.display = 'flex';
                document.getElementById('tagInput').value = '';
            }
        </script>
    </body>
</html>
